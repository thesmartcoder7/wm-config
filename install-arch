#!/usr/bin/bash

# Arch Linux Installation Script for WM Configuration

# Color codes for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

print_status() {
    echo -e "${BLUE}[INFO]${NC} $1"
}

print_success() {
    echo -e "${GREEN}[SUCCESS]${NC} $1"
}

print_warning() {
    echo -e "${YELLOW}[WARNING]${NC} $1"
}

# Update system
print_status "Updating system packages..."
sudo pacman -Syu --noconfirm

# Install DWM dependencies
print_status "Installing DWM Dependencies..."
sudo pacman -S --noconfirm \
    xorg-server \
    xorg-xinit \
    xorg-xrandr \
    libxinerama \
    libxft \
    libx11 \
    libxcb \
    base-devel \
    xorg-fonts-misc

# Install core applications
print_status "Installing Core Applications..."
sudo pacman -S --noconfirm \
    wget \
    curl \
    btop \
    mpv \
    picom \
    audacity \
    chromium \
    kitty \
    clementine \
    gimp \
    neofetch \
    pipewire \
    pipewire-alsa \
    pipewire-pulse \
    pipewire-jack \
    wireplumber \
    networkmanager \
    pavucontrol \
    dbus \
    mlocate \
    zip \
    unzip \
    python-pipenv \
    tor \
    flameshot \
    feh \
    discord \
    telegram-desktop \
    firefox \
    obsidian \
    libreoffice-fresh

# Install AUR helper (yay) if not present
if ! command -v yay &> /dev/null; then
    print_status "Installing yay AUR helper..."
    git clone https://aur.archlinux.org/yay.git /tmp/yay
    cd /tmp/yay
    makepkg -si --noconfirm
    cd -
fi

# Install AUR packages
print_status "Installing AUR packages..."
yay -S --noconfirm \
    brave-bin \
    thorium-browser-bin \
    librewolf-bin \
    visual-studio-code-bin \
    spotify \
    4kvideodownloader \
    ferdium-bin \
    timeshift \
    stacer \
    notion-app \
    slack-desktop

# Enable essential services
print_status "Enabling essential services..."
sudo systemctl enable NetworkManager
sudo systemctl enable pipewire
sudo systemctl enable pipewire-pulse

# Update locate database
print_status "Updating locate database..."
sudo updatedb

print_success "Arch Linux installation completed!"
print_warning "Please reboot your system to ensure all services are properly started."
print_status "After reboot, you can build the suckless tools using the instructions in the README."
