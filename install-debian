#!/usr/bin/bash

# Debian/Ubuntu Installation Script for WM Configuration

# Color codes for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

print_status() {
    echo -e "${BLUE}[INFO]${NC} $1"
}

print_success() {
    echo -e "${GREEN}[SUCCESS]${NC} $1"
}

print_warning() {
    echo -e "${YELLOW}[WARNING]${NC} $1"
}

# Update system
print_status "Updating system packages..."
sudo apt update && sudo apt upgrade -y

# Install DWM dependencies
print_status "Installing DWM Dependencies..."
sudo apt install -y \
    xorg \
    xinit \
    libxinerama-dev \
    libx11-dev \
    libxft-dev \
    libx11-xcb-dev \
    libxcb-res0-dev \
    libxrandr-dev \
    build-essential \
    xserver-xorg-input-all \
    xfonts-base

# Install core applications from Debian packages
print_status "Installing Core Applications..."
sudo apt install -y \
    wget \
    curl \
    btop \
    mpv \
    picom \
    audacity \
    chromium-browser \
    kitty \
    clementine \
    gimp \
    neofetch \
    alsa-utils \
    pulseaudio \
    network-manager \
    pavucontrol \
    dbus \
    locate \
    zip \
    unzip \
    pipenv \
    tor \
    flameshot \
    feh \
    git \
    vim \
    neovim \
    htop \
    tree \
    nodejs \
    npm \
    python3-pip \
    cmake \
    gdb \
    strace \
    wireshark \
    nmap \
    obs-studio \
    vlc \
    libreoffice \
    discord \
    telegram-desktop \
    firefox-esr

# Install Flatpak
print_status "Installing Flatpak..."
sudo apt install -y flatpak
sudo flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo

# Install additional applications via Flatpak
print_status "Installing additional applications via Flatpak..."
flatpak install -y flathub \
    com.vscodium.codium \
    com.spotify.Client \
    org.signal.Signal \
    com.slack.Slack \
    md.obsidian.Obsidian \
    com.notion.Notion \
    org.freedesktop.Piper \
    com.github.tchx84.Flatseal

# Install third party browsers
print_status "Installing third-party browsers..."

# Brave browser
sudo curl -fsSLo /usr/share/keyrings/brave-browser-archive-keyring.gpg \
    https://brave-browser-apt-release.s3.brave.com/brave-browser-archive-keyring.gpg
echo "deb [signed-by=/usr/share/keyrings/brave-browser-archive-keyring.gpg] \
    https://brave-browser-apt-release.s3.brave.com/ stable main" | \
    sudo tee /etc/apt/sources.list.d/brave-browser-release.list
sudo apt update
sudo apt install -y brave-browser

# Thorium browser
sudo rm -fv /etc/apt/sources.list.d/thorium.list
sudo wget --no-hsts -P /etc/apt/sources.list.d/ \
    http://dl.thorium.rocks/debian/dists/stable/thorium.list
sudo apt update
sudo apt install -y thorium-browser

# LibreWolf browser
sudo apt update && sudo apt install -y extrepo
sudo extrepo enable librewolf
sudo apt update && sudo apt install -y librewolf

# Update locate database
print_status "Updating locate database..."
sudo updatedb

print_success "Debian/Ubuntu installation completed!"
print_warning "Please reboot your system to ensure all services are properly started."
print_status "After reboot, you can build the suckless tools using the instructions in the README."
print_status "Some Flatpak applications may require a logout/login to appear in your application menu."

